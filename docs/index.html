<!DOCTYPE html>
<html>

<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<title>AHP</title>

	<link rel="stylesheet" type="text/css" href="css/styles.css" />

	<script type="text/javascript" src="js/jquery-1.2.6.js"></script>
	<script type="text/javascript" src="js/ahpCalc.obj.js"></script>
	<script type="text/javascript" src="js/site.js"></script>
	<script type="text/javascript" src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
</head>

<body>
	<div class="container">

		<!-- poll setup-->
		<div class="setup">
			<h3>電影、電視劇內容評等系統雛形</h3>
			<!-- question text -->
			<!--
			<fieldset>
			<legend>提問</legend>
			<label>輸入您設定的目標問題。例如：哪個特徵更為重要？</label>
			<input class="questionTextInput" style="width: 20em; font-size:20px" value="哪個特徵更為重要？" placeholder="請輸入您的目標問題？"/>
		</fieldset>
	-->
			<!-- option list -->
			<fieldset>
				<legend>層指標建立(主層、次層、第三層、第四層)</legend>

				<!-- add an option -->
				<!--
		<div class="newOption">
		<label>New Option:</label><input id="optionText" style="width: 20em;"/>
		<a href="#" id="addOption">Add</a>
	</div>
-->
				<!-- add multiple options -->
				<div class="newOption">
					<label>請選擇特徵：</label><br />
					<select id="layerType">
						<option selected>---請選擇---</option>
						<option value=0>TV</option>
						<option value=1>Movie</option>
					</select>
					<select id="layerTVList" style="display:none">
						<option selected>---請選擇---</option>
						<option value=0>負責人的經驗水準</option>
						<option value=1>管理能力</option>
						<option value=2>製作團隊組合</option>
						<option value=3>資金籌措能力</option>
						<option value=4>編劇能力</option>
						<option value=5>製作人能力</option>
						<option value=6>導演能力</option>
						<option value=7>演員(男/女主角)能力及受歡迎程度</option>
						<option value=8>製作團隊默契</option>
						<option value=9>題材的潛力</option>
						<option value=10>劇本流行性</option>
						<option value=11>電視台播放確認</option>
						<option value=12>預算之合理性</option>
						<option value=13>資金到位情況</option>
						<option value=14>製作管理能力</option>
						<option value=15>契約確認</option>
						<option value=16>銷售契約</option>
						<option value=17>行銷能力</option>
						<option value=18>收入管道</option>
						<option value=19>預售情形</option>
						<option value=20>投資報酬率</option>
						<option value=21>擴散效果</option>
						<option value=22>負責人的能力</option>
						<option value=23>企業能力</option>
						<option value=24>製作能力</option>
						<option value=25>作品內容核心元素</option>
						<option value=26>完工能力</option>
						<option value=27>目標市場行銷</option>
						<option value=28>潛在獲利能力</option>
						<option value=29>製作的基礎</option>
						<option value=30>製作內容之競爭力</option>
						<option value=31>價值創造(獲利性)</option>
						<option value=32>主層面</option>
					</select>
					<select id="layerMovieList" style="display:none">
						<option selected>---請選擇---</option>
						<option value=0>負責人(監製)的經驗水準</option>
						<option value=1>管理能力</option>
						<option value=2>製作團隊組合</option>
						<option value=3>資金籌措能力</option>
						<option value=4>編劇能力</option>
						<option value=5>製片能力</option>
						<option value=6>導演能力</option>
						<option value=7>演員(男/女主角)能力及受歡迎程度</option>
						<option value=8>製作團隊默契</option>
						<option value=9>題材的潛力</option>
						<option value=10>劇本的競爭性</option>
						<option value=11>劇本內容品質確認</option>
						<option value=12>預算之合理性</option>
						<option value=13>資金到位程度</option>
						<option value=14>製作管理能力</option>
						<option value=15>契約確認</option>
						<option value=16>銷售契約</option>
						<option value=17>行銷能力</option>
						<option value=18>利潤分配結構</option>
						<option value=19>預售情形</option>
						<option value=20>投資報酬率</option>
						<option value=21>擴散效果</option>
						<option value=22>負責人(監製)的能力</option>
						<option value=23>企業能力(電影公司能力)</option>
						<option value=24>製作能力</option>
						<option value=25>核心元素之品質</option>
						<option value=26>完工能力</option>
						<option value=27>目標市場行銷</option>
						<option value=28>潛在獲利能力</option>
						<option value=29>製作基礎</option>
						<option value=30>製作內容之競爭力</option>
						<option value=31>價值創造(獲利性)</option>
						<option value=32>主層面</option>
					</select>
					<script type="text/javascript">
						$('#layerType').on('change', function(e) {
							var optionSelected = $("option:selected", this);
							var valueSelected = this.value;
							if (valueSelected == 0) {
								$("#layerTVList").css("display", "block");
								$("#layerMovieList").css("display", "none");
								$("#layerType").css("display", "none");
							} else {
								$("#layerTVList").css("display", "none");
								$("#layerMovieList").css("display", "block");
								$("#layerType").css("display", "none");
							}
						})
						$('#layerTVList').on('change', function(e) {
							var optionSelected = $("option:selected", this);
							var valueSelected = this.value;
							displayHelper.addBySelectOptionsToList(valueSelected, "TV");
							showOption(valueSelected);
						});
						$('#layerMovieList').on('change', function(e) {
							var optionSelected = $("option:selected", this);
							var valueSelected = this.value;
							displayHelper.addBySelectOptionsToList(valueSelected, "MOVIE");
							showOption(valueSelected);
						});

						function showOption(valueSelected) {
							if (valueSelected > 21) {
								$("#optionArea").css("display", "none");
								$("#optionText").css("display", "none");
								$("#multiOptionText").css("display", "none");
								$("#addMultiOptions").css("display", "none");
							} else {
								$("#optionArea").css("display", "block");
								$("#optionText").css("display", "block");
								$("#multiOptionText").css("display", "block");
								$("#addMultiOptions").css("display", "block");
							}
						}
					</script>
					<div id="optionArea">
						<br>
						<label id="optionText">請輸入特徵，並以換行做為每個特徵的間隔：</label><br />
						<textarea rows="10" id="multiOptionText" style="width: 40em;"></textarea><br />
						<input type="button" id="addMultiOptions" class="addButton" value="新增 +" /><br />
					</div>
					<!--<input type="button" value="清除" onclick="$('#optionsList').empty();" /><br/>-->
					<table id="optionsList"></table>
				</div>
				<div>
					<h1>電影、電視劇內容評等模型-問卷填答說明</h1>

<p>本問卷的設計採用Saaty所建議的評量尺度，對每一個評估準則劃分等級進行成對的比較，層級分析法的實務操作邏輯乃是「必須秉持因素間相對重要性排序的一致性」，填答過程的排序失誤會導致「廢卷」的遺憾。於下以條列方式提供問卷填答說明：
<div style="color:red;">一、請於下拉式選單中選擇評估之類別，電影(Movie)或電視(TV)。</div>
<div style="color:red;">二、建議按下拉式選單所列之指標順序填答，回答完一組題組再選擇下一組指標進行評估。</div>
三、依「兩兩比較」方式，在1、2、3、4、5（同等重要、稍微重要、重要、相當重要、非常重要）的衡量值中，<div style="color:red;display: inline;">評估指標間之相對重要強度</div>。
四、範例：若您認為左邊的指標重要性較大，請在偏左的適當強度中勾選；若您認為右邊的指標重要性較大，請在偏右的適當強度中勾選。<div style="color:red;display: inline;">（每一列僅勾選一項）</div>。
例如，假設您在評估電影的影響因素，考慮的準則為 1.製作的基礎設施；2.製作內容之競爭力等兩項，<div style="color:red;display: inline;">若您覺得「製作內容之競爭力」的相對重要性大於「製作的基礎設施」</div>，填寫方式如下所示：
<div style="color:red;display: inline;">請勾選兩兩因素的「相對重要程度」</div>
AHP問卷中有關準則評估的填寫範例</p>
<img src="img/sheet.png"></img>
<p style="color:red;">**此範例顯示受訪者認為「製作內容之競爭力」比「製作的基礎設施」重要。</p>
				</div>
			</fieldset>

		</div>

		<!-- start,stop, retry buttons -->
		<div style="text-align:center;">
			<input type="button" class="startPoll buttonControl" value="開始作答" />
			<input type="button" class="stopPoll buttonControl" style="display:none;" value="停止" />
			<input type="button" class="changePoll buttonControl" style="display:none;" value="重新開始" />
			<input type="button" class="changePoll buttonControl" style="display:none;" onclick="parsePollResults()" value="表格顯示" />
		</div>

		<!-- poll questions -->
		<div id="pollQuestions" class="" style="display:none;">
			<!-- displlay poll pair -->
			<h3>輪詢提問</h3>

			<table>
				<tr>
					<td class="pollQuestionTitle" colspan="3"><span class="questionTextDisplay">提問</span></td>
				</tr>
				<tr>
					<td class="pollQuestion" id="pollQuestion1">&nbsp;</td>
					<td />
					<td class="pollQuestion" id="pollQuestion2">&nbsp;</td>
				</tr>

				<!-- Simple voting buttons -->
				<!--<tr class="simplePollButtons">
		<td>
		<input type="button" id="L_MuchMore" value="&lt;&lt;&nbsp;更重要" />
		<button type="button" id="L_MuchMore" style="vertical-align:middle" onclick = ""><span> 更重要</span></button>

		<input type="button" id="L_SlightlyMore" value="&lt;&nbsp;些微重要" />
		<button type="button" id="L_SlightlyMore" style="vertical-align:middle"><span> 些微重要</span></button>
	</td>
	<td>

	<button type="button" id="L_R_Same" style="vertical-align:middle"><span>一樣重要</span></button>

	<input type="button" class="pollVoteLink" id="L_R_Same" value="一樣重要" />
</td>
<td>
<input type="button" id="R_SlightlyMore" value="些微重要&nbsp;&gt;"/>
<button type="button" id="R_SlightlyMore" style="vertical-align:middle"><span>些微重要 </span></button>

<button type="button" id="R_MuchMore" style="vertical-align:middle"><span>更重要 </span></button>
<input type="button" id="R_MuchMore" value="更重要&nbsp;&gt;&gt;" />
</td>
</tr>
-->
				<!-- Detailed voting buttons -->
				<tr class="detailedPollButtons">
					<td>
						<input type="button" class="leftMore" value="5" />
						<input type="button" class="leftMore" value="4" />
						<input type="button" class="leftMore" value="3" />
						<input type="button" class="leftMore" value="2" />
					</td>
					<td>
						<input type="button" class="same" value="1" />
					</td>
					<td>
						<input type="button" class="rightMore" value="2" />
						<input type="button" class="rightMore" value="3" />
						<input type="button" class="rightMore" value="4" />
						<input type="button" class="rightMore" value="5" />

					</td>
				</tr>

			</table>
			<span class="questionIndex">0</span>
		</div>

		<!-- results -->
		<div id="pollResults">
			<h3>運算結果</h3>
		</div>
		<script>
		var resultDict={}
		function parsePollResults(){
			var pollResultTable = document.getElementsByClassName('pollResultTable');
			for (var i=0;i<pollResultTable.length;i++){
				var resultSetQuestionText = pollResultTable[i].getElementsByClassName('resultSetQuestionText')[0].innerText.split(":")[1];
				//console.log(pollResultTable[i].getElementsByClassName('resultSetQuestionText')[0].innerText);
				for (var j=0;j<pollResultTable[i].getElementsByClassName('resultSetOptionText').length;j++){
					resultDict[pollResultTable[i].getElementsByClassName('resultSetOptionText')[j].innerText]=pollResultTable[i].getElementsByClassName('result')[j].innerText;
				}
			}
			localStorage.setItem("resultDict", JSON.stringify(resultDict));
			//console.log(resultDict);
			if($("#layerType").val()==0){
				window.open("resultTVTable.html");
			}else{
				window.open("resultMovieTable.html");
			}

		}
		</script>
	</div>
</body>

</html>
